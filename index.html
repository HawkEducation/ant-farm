<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dr. Plants: 1000 Day Empire üêú</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üêú</text></svg>">
    
    <style>
        body { background: #1a1a1a; color: #e0e0e0; font-family: 'Courier New', Courier, monospace; text-align: center; margin: 0; padding: 10px; }
        #game-container { max-width: 500px; margin: 0 auto; background: #262626; padding: 20px; border-radius: 15px; border: 3px solid #00ffff; position: relative; overflow: hidden; }
        
        /* Queen Health Bar */
        #queen-health-container { width: 100%; height: 20px; background: #441111; border-radius: 10px; margin-bottom: 5px; border: 1px solid #ff4444; overflow: hidden; }
        #health-bar { width: 100%; height: 100%; background: #ff4444; transition: width 0.3s; }
        
        .stat-box { display: flex; flex-wrap: wrap; justify-content: space-around; background: #000; padding: 10px; border-radius: 10px; margin-bottom: 10px; border: 1px solid #333; }
        .stat { color: #00ffff; font-weight: bold; }
        .dead { color: #ff6666; font-size: 0.85em; }
        
        button { background: #00ffff; color: #111; border: none; padding: 12px; font-weight: bold; border-radius: 8px; cursor: pointer; margin: 5px; width: 90%; transition: 0.1s; }
        button:active { transform: scale(0.98); }
        button:disabled { background: #444; color: #888; cursor: not-allowed; }
        
        .battle-zone { background: #4a0000; padding: 15px; border-radius: 10px; display: none; border: 2px solid #ff0000; margin-bottom: 10px; }
        .alert { color: #ff4444; font-weight: bold; min-height: 40px; margin-bottom: 10px; }

        /* Day 1000 Win Screen */
        #win-screen { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 255, 255, 0.95); color: #000; z-index: 10; flex-direction: column; justify-content: center; align-items: center; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="win-screen">
        <h1>üèÜ DAY 1000 REACHED!</h1>
        <p>The Empire is Secure.</p>
        <button onclick="location.reload()" style="background: #000; color: #fff;">START NEW ERA</button>
    </div>

    <div id="queen-health-container">
        <div id="health-bar"></div>
    </div>
    <small>QUEEN STRENGTH</small>

    <h1>Day: <span id="day-display">1</span></h1>

    <div class="stat-box">
        <div>Workers: <span id="ant-count" class="stat">1</span></div>
        <div>Soldiers: <span id="soldier-count" class="stat">0</span></div>
        <div>Bread: <span id="bread-count" class="stat">0</span></div>
    </div>

    <div class="stat-box" style="border-color: #555;">
        <div>Seeds: <span id="seed-count" class="stat">0</span></div>
        <div class="dead">Graveyard: <span id="graveyard-count">0</span></div>
    </div>

    <div id="status-msg" class="alert">The colony begins...</div>

    <div id="battle-ui" class="battle-zone">
        <p>‚ö†Ô∏è NEST UNDER ATTACK! ‚ö†Ô∏è</p>
        <button onclick="fightInvasion()" style="background: #ff0000; color: white;">TAP TO DEFEND</button>
        <p>Enemies: <span id="enemy-count">0</span></p>
    </div>

    <div id="controls">
        <button id="forage-btn" onclick="forage()">Forage (Seeds) üåæ</button>
        <button id="bakery-btn" onclick="startBakery()" disabled>Bakery (5 Seeds) ü•ñ</button>
        <button id="soldier-btn" onclick="trainSoldier()">Train Soldier (15 Bread) ‚öîÔ∏è</button>
        <button id="upgrade-btn" onclick="upgradeColony()">Mandible Upgrade (10 Bread) üí™</button>
    </div>
</div>

<script>
    let ants = 1, soldiers = 0, seeds = 0, bread = 0, day = 1, dead = 0, queenHP = 100;
    let pickupAmount = 1, bakeryTime = 4000, upgradeCost = 10, enemies = 0;

    // Fixed Audio: A simple mechanical click (Natural sound)
    const clickSound = new Audio('https://www.soundjay.com/buttons/button-16.mp3');

    function updateUI() {
        document.getElementById('ant-count').innerText = ants;
        document.getElementById('soldier-count').innerText = soldiers;
        document.getElementById('bread-count').innerText = bread;
        document.getElementById('seed-count').innerText = seeds;
        document.getElementById('day-display').innerText = day;
        document.getElementById('graveyard-count').innerText = dead;
        document.getElementById('health-bar').style.width = queenHP + "%";
        
        const inBattle = (enemies > 0);
        document.getElementById('bakery-btn').disabled = (seeds < 5 || inBattle);
        document.getElementById('soldier-btn').disabled = (bread < 15 || inBattle);
        document.getElementById('upgrade-btn').disabled = (bread < upgradeCost || inBattle);

        if (day >= 1000) {
            document.getElementById('win-screen').style.display = 'flex';
        }
    }

    function forage() { if(enemies === 0) { seeds += pickupAmount; updateUI(); } }

    function trainSoldier() {
        if (bread >= 15) { bread -= 15; soldiers++; updateUI(); }
    }

    function startBakery() {
        if (seeds < 5) return;
        seeds -= 5; updateUI();
        setTimeout(() => {
            bread += 5; ants += 2;
            clickSound.play(); 
            document.getElementById('status-msg').innerText = "Bread processed!";
            updateUI();
        }, bakeryTime);
    }

    function triggerInvasion() {
        enemies = Math.floor(ants * 0.7) + 5;
        document.getElementById('battle-ui').style.display = 'block';
        document.getElementById('enemy-count').innerText = enemies;
        document.getElementById('status-msg').innerText = "WILD COLONY BREACH!";
    }

    function fightInvasion() { if (enemies > 0) { enemies--; updateUI(); if(enemies <= 0) endBattle(); } }

    function endBattle() {
        enemies = 0; document.getElementById('battle-ui').style.display = 'none';
        document.getElementById('status-msg').innerText = "Area secured."; updateUI();
    }

    // Main Game Loop (Combat & Deaths)
    setInterval(() => {
        if (enemies > 0) {
            enemies -= soldiers; // Soldiers kill enemies 1 per second
            if (enemies < 0) enemies = 0;
            
            // Death chance logic
            if (Math.random() > 0.85 && soldiers > 0) { soldiers--; dead++; }
            else if (soldiers === 0 && Math.random() > 0.7 && ants > 1) { ants--; dead++; }
            
            // Damage to Queen if undefended
            if (soldiers === 0 && ants <= 1) {
                queenHP -= 5;
                document.getElementById('status-msg').innerText = "QUEEN TAKING DAMAGE!";
            }
            
            if (queenHP <= 0) { alert("The Empire fell on Day " + day); location.reload(); }
            
            document.getElementById('enemy-count').innerText = enemies;
            if(enemies <= 0) endBattle();
            updateUI();
        }
    }, 1000);

    // Day Cycle
    setInterval(() => {
        day++;
        if (day > 10 && Math.random() > 0.90 && enemies === 0) triggerInvasion();
        updateUI();
    }, 4000);

    function upgradeColony() {
        if (bread >= upgradeCost) {
            bread -= upgradeCost;
            pickupAmount += 3;
            upgradeCost = Math.floor(upgradeCost * 2.3);
            updateUI();
        }
    }
</script>
</body>
</html>
